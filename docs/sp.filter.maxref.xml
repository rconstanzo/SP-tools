<?xml version='1.0' encoding='utf-8' standalone='yes'?>
<?xml-stylesheet href="./_c74_ref.xsl" type="text/xsl"?>

<c74object name='sp.filter' category='' module='SP-Tools'>
    <digest>Apply filtering/routing to incoming descriptor messages</digest>
    <description>Apply filtering/routing to incoming descriptor messages.</description>
    <discussion>    <h4><openfilelink filename="SP-Tools Overview.maxpat">Open the Overview Patch</openfilelink></h4>
    <p>The <o>sp.filter</o> object allows you to selectively send incoming descriptor messages to one of two outlets depending on whether the filtering criteria is met. This allows you to fork processing based on audio characteristics.</p>
</discussion>

	<metadatalist>
		<metadata name='author'>Rodrigo Constanzo, Flucoma Project</metadata>
		<metadata name='tag'>Machine Learning</metadata>
		<metadata name='tag'>Drums</metadata>
	</metadatalist>

    <!-- INLETS -->
    <inletlist>
        <inlet id='0' type='list'>
            <digest>Descriptor in</digest>
            <description>Descriptor input as list or <o>buffer~</o>.</description>
        </inlet>
        <inlet id='1' type='list'>
            <digest>Descriptor in to be filtered</digest>
            <description>Descriptor input as list or <o>buffer~</o> that will be filtered by the input of the left-most inlet.</description>
        </inlet>
    </inletlist>
    <!-- INLETS -->

    <!-- OUTLETS -->
    <outletlist>
        <outlet id='0' type='list'>
            <digest>Descriptor output if conditions are met</digest>
            <description>Descriptor output if conditions are met. Output will be list or <o>buffer~</o> based on what the input was.</description>
        </outlet>
        <outlet id='1' type='list'>
            <digest>Descriptor output if conditions are not met</digest>
            <description>Descriptor output if conditions are not met. Output will be list or <o>buffer~</o> based on what the input was.</description>
        </outlet>
    </outletlist>
    <!-- OUTLETS -->

    <!-- ARGUMENTS -->
    <objarglist>
    </objarglist>
    <!-- ARGUMENTS -->

    <!--MESSAGES-->
    <methodlist>
	</methodlist>
	<!--MESSAGES-->

	<!--ATTRIBUTES-->
	<attributelist>
        <attribute 
        name='filter' 
        type='' 
        size=''
        get='1' set='1' 
        >
        <digest>Messages related to corpus filtering</digest>
        <description>Messages related to corpus filtering.<br/>
After sending the <m>filter</m> message you send a series of additional arguments that determine what descriptor is being filtered, how it is being filtered, as well as further filtering strangs combined with conditionals.<br/>
The available descriptors that can be used for filtering are:<br/>
<b>loudness</b> = loudness in <b>dB</b><br/>
<b>loudness_derivative</b> = derivative of loudness in <b>dB</b><br/>
<b>centroid</b> = centroid in <b>MIDI pitch</b><br/>
<b>centroid_derivative</b> = derivative of centroid in <b>MIDI pitch</b><br/>
<b>flatness</b> = spectral flatness in <b>dB</b><br/>
<b>flatness_derivative</b> = derivative of spectral flatness in <b>dB</b><br/>
<b>pitch</b> = pitch in <b>MIDI pitch</b><br/>
<b>pitch_confidence</b> = pitch confidence in <b>0 to 1</b><br/>
You can filter by the following operators:<br/>
<b>==</b> = equals<br/>
<b>!=</b> = does not equal<br/>
<b>&lt;</b> = less than<br/>
<b>&lt;=</b> = less than or equal<br/>
<b>&gt;</b> = greater than<br/>
<b>&gt;=</b> = greater than or equal<br/>
You can join multiple queries using:<br/>
<b>and</b>
<b>or</b><br/><br/>
Therefore a complete message would look as follows:<br/>
'filter loudness &lt; -45' or 'filter duration &gt; 2500' or 'filter centroid &gt; 60 and time_centroid &lt; 80'<br/><br/>
</description>

        <attributelist>
            <attribute 
            name='default' 
            type='list' 
            size='1' 
            value=''
            get='1' set='1' 
            />
        </attributelist>
        </attribute>
	</attributelist>
	<!--ATTRIBUTES-->

	<!-- SEEALSO -->
	<seealsolist>
        <seealso name='sp.descriptors~' />
        <seealso name='sp.descriptorframe' />
        <seealso name='sp.mfccframe' />
        <seealso name='sp.melbandframe' />
        <seealso name='sp.onsetframe~' />
        <seealso name='sp.corpusmatch' />
        <seealso name='sp.classmatch' />
        <seealso name='sp.concatanalysis~' />
	</seealsolist>
	<!-- SEEALSO -->

    <!-- INLETS -->
    <misc name="Input">
        <entry name='list'>
            <description>Descriptor input as list or <o>buffer~</o>.</description>
        </entry>
        <entry name='list'>
            <description>Descriptor input as list or <o>buffer~</o> that will be filtered by the input of the left-most inlet.</description>
        </entry>
    </misc> 
    <!-- INLETS -->

    <!-- OUTLETS -->
    <misc name="Output">
        <entry name='list'>
            <description>Descriptor output if conditions are met. Output will be list or <o>buffer~</o> based on what the input was.</description>
        </entry>
        <entry name='list'>
            <description>Descriptor output if conditions are not met. Output will be list or <o>buffer~</o> based on what the input was.</description>
        </entry>
    </misc>
    <!-- OUTLETS -->
</c74object>
